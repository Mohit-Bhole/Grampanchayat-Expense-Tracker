{% extends 'base.html' %}
{% block content %}
<h1 class="page-title">Admin Dashboard</h1>
<div class="grid-2">
	<section class="card">
		<h2>Add Expense</h2>
		<form method="post" action="{{ url_for('admin_create_expense') }}" class="form-grid">
			<label>
				<span>Title</span>
				<input type="text" name="title" placeholder="Expense title" required>
			</label>
			<label>
				<span>Amount (₹)</span>
				<input type="number" step="0.01" name="amount" placeholder="0.00" required>
			</label>
			<label>
				<span>Date</span>
				<input type="date" name="date_spent" required>
			</label>
			<label>
				<span>Category</span>
				<select name="category_id" required>
					<option value="">Select category</option>
					{% for c in categories %}
						<option value="{{ c.id }}">{{ c.name }}</option>
					{% endfor %}
				</select>
			</label>
			<label class="full">
				<span>Description</span>
				<textarea name="description" rows="3" placeholder="Optional details"></textarea>
			</label>
			<label class="full">
				<span>Receipt URL</span>
				<input type="url" name="receipt_url" placeholder="Link to receipt or file">
			</label>
			<button class="btn btn-primary" type="submit">Add Expense</button>
		</form>
	</section>
	<section class="card">
		<h2>New Category</h2>
		<form method="post" action="{{ url_for('admin_create_category') }}" class="form-inline">
			<input type="text" name="name" placeholder="Category name" required>
			<button class="btn btn-secondary" type="submit">Add</button>
		</form>
		<h3>Categories</h3>
		<ul class="list">
			{% for c in categories %}
				<li>{{ c.name }}</li>
			{% endfor %}
		</ul>
	</section>
</div>

<div class="grid-2">
	<section class="card">
		<h2>Recent Expenses</h2>
		<table class="table">
			<thead>
				<tr>
					<th>Title</th>
					<th>Category</th>
					<th class="num">Amount (₹)</th>
					<th>Date</th>
					<th>Receipt</th>
				</tr>
			</thead>
			<tbody>
				{% for e in expenses %}
				<tr>
					<td>{{ e.title }}</td>
					<td>{{ e.category.name if e.category else '' }}</td>
					<td class="num">{{ '%.2f'|format(e.amount) }}</td>
					<td>{{ e.date_spent }}</td>
					<td>{% if e.receipt_url %}<a href="{{ e.receipt_url }}" target="_blank">View</a>{% else %}-{% endif %}</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</section>
	<section class="card">
		<h2>Announcement</h2>
		<form method="post" action="{{ url_for('admin_create_announcement') }}" class="form-grid">
			<label>
				<span>Title</span>
				<input type="text" name="title" placeholder="Announcement title" required>
			</label>
			<label class="full">
				<span>Body</span>
				<textarea name="body" rows="3" placeholder="Write the message" required></textarea>
			</label>
			<button class="btn btn-primary" type="submit">Publish</button>
		</form>
		<h3>Recent</h3>
		<ul class="list">
			{% for a in announcements %}
				<li><strong>{{ a.title }}</strong> — {{ a.created_at.strftime('%Y-%m-%d') }}</li>
			{% endfor %}
		</ul>
	</section>
</div>
{% endblock %}
